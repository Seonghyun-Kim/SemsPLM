<?xml version="1.0" encoding="utf-8" ?>
<sqlMap
 namespace="ChangeOrder"
	xmlns="http://ibatis.apache.org/mapping"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <alias>
    <typeAlias alias="ECO"  type="ChangeOrder.Models.ECO" />
  </alias>

  <statements>
    <insert id="InsChangeOrder" parameterClass="ECO">
      INSERT INTO T_DCHANGE_ORDER
      (OID
      ,ItemGroup
      ,Title
      ,DesignChangeDt
      ,ReasonChange
      ,Compatible
      ,IsMold
      ,ReasonRegistration
      ,Security
      ,Changes
      ,Stock
      ,Memo
      ,IsAttached
      ,SelRequestDt
      ,SelPartNo
      ,EBom
      ,DevMP
      ,CarType
      )
      VALUES
      (#OID#
      ,#ItemGroup#
      ,#Title#
      ,#DesignChangeDt#
      ,#ReasonChange#
      ,#Compatible#
      ,#IsMold#
      ,#ReasonRegistration#
      ,#Security#
      ,#Changes#
      ,#Stock#
      ,#Memo#
      ,#IsAttached#
      ,#SelRequestDt#
      ,#SelPartNo#
      ,#EBom#
      ,#DevMP#
      ,#CarType#
      )
    </insert>
    
    <select id="SelChangeOrder" parameterClass="ECO" resultClass="ECO">
      SELECT
      A.*
      , B.*
      FROM T_DOBJECT A
      LEFT OUTER JOIN T_DCHANGE_ORDER B ON A.OID = B.OID
      <dynamic prepend="where">
        <isNotNull prepend="and" property="Type">
          A.Type = #Type#
        </isNotNull>
        <isNotNull prepend="and" property="OID">
          A.OID = #OID#
        </isNotNull>
        <isNotNull prepend="and" property="Name">
          A.Name LIKE CONCAT('%',#Name#,'%')
        </isNotNull>
         <isNotNull prepend="and" property="DevMP">
          B.DevMP = #DevMP#
        </isNotNull>
        <isNotNull prepend="and" property="Description">
          A.Description LIKE CONCAT('%',#Description#,'%')
        </isNotNull>
        <isNotNull prepend="and" property="Title">
          B.Title LIKE CONCAT('%',#Title#,'%')
        </isNotNull>
        <isNotNull prepend="and" property="StartDesignChangeDt">
          B.DesignChangeDt &gt;= #StartDesignChangeDt#
        </isNotNull>
        <isNotNull prepend="and" property="EndDesignChangeDt">
          B.DesignChangeDt &lt;= #EndDesignChangeDt#
        </isNotNull>
      </dynamic>
      AND A.DeleteDt IS NULL
    </select>



    <select id="SelChangeOrderCheck" parameterClass="ECO" resultClass="ECO">
      SELECT
      A.*
      , B.*
      FROM T_DOBJECT A
      LEFT OUTER JOIN T_DCHANGE_ORDER B ON A.OID = B.OID
      <dynamic prepend="where">
        <isNotNull prepend="and" property="Type">
          A.Type = #Type#
        </isNotNull>
        <isNotNull prepend="and" property="Name">
          A.Name = #Name#
        </isNotNull>
      </dynamic>
      AND A.DeleteDt IS NULL
    </select>


    <update id="UdtChangeOrder" parameterClass="ECO">
      UPDATE T_DCHANGE_ORDER SET
      ItemGroup = #ItemGroup#
      ,Title = #Title#
      ,DesignChangeDt = #DesignChangeDt#
      ,ReasonChange = #ReasonChange#
      ,Compatible = #Compatible#
      ,IsMold = #IsMold#
      ,ReasonRegistration = #ReasonRegistration#
      ,Security = #Security#
      ,Changes = #Changes#
      ,Stock = #Stock#
      ,Memo = #Memo#
      ,IsAttached = #IsAttached#
      ,SelRequestDt = #SelRequestDt#
      ,SelPartNo = #SelPartNo#
      ,EBom = #EBom#
      ,DevMP = #DevMP#
      ,CarType = #CarType#
      WHERE OID   =  #OID#
    </update>
    
    
  </statements>

</sqlMap>