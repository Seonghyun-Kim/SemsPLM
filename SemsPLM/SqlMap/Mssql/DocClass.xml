<?xml version="1.0" encoding="utf-8" ?>
<sqlMap
 namespace="DocClass"
	xmlns="http://ibatis.apache.org/mapping"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <alias>
    <typeAlias alias="DocClass"  type="DocumentClassification.Models.DocClass" />
  </alias>
  <statements>

    <select id="SelDocClass" parameterClass="DocClass" resultClass="DocClass">
      SELECT
      A.*
      , B.*
      FROM T_DOBJECT A
      LEFT OUTER JOIN T_DDOCUMENT_CLASSIFICATION B ON A.OID = B.OID
      WHERE A.Type = #Type#
      <isNotNull prepend="and" property="OID">
        A.OID = #OID#
      </isNotNull>
      <isNotNull prepend="and" property="FromOID">
        B.FromOID = #FromOID#
      </isNotNull>
      <isNotNull prepend="and" property="Name">
        A.Name like '%' + #Name# + '%'
      </isNotNull>
      <isNotNull prepend="and" property="Code">
        A.Code = #Code#
      </isNotNull>
      <isNotNull prepend="and" property="ViewUrl">
        A.ViewUrl = #ViewUrl#
      </isNotNull>
      AND A.DeleteDt IS NULL
    </select>
    
    <insert id="InsDocClass" parameterClass="DocClass">
      INSERT INTO T_DDOCUMENT_CLASSIFICATION
      ( OID
      , FromOID
      , Classification
      , Code
      , ViewUrl
      , IsUse)
      VALUES
      ( #OID#
      , #FromOID#
      , #Classification#
      , #Code#
      , #ViewUrl#
      , #IsUse#)
    </insert>
    
    <update id="UdtDocClass" parameterClass="DocClass">
      UPDATE T_DDOCUMENT_CLASSIFICATION
      SET IsUse = #IsUse#
      WHERE OID = #OID#
    </update>

    <select id="SelProjectDocClass" parameterClass="DocClass" resultClass="DocClass">
      SELECT
      A.*
      , B.*
      , C.Name AS CreateUsNm
      FROM T_DOBJECT A
      LEFT OUTER JOIN T_DDOCUMENT_CLASSIFICATION B ON A.OID = B.OID
      LEFT OUTER JOIN T_DOBJECT C ON A.CreateUs = C.OID
      WHERE A.Type = #Type#
      AND (A.OID = #OID#
      OR B.FromOID = #FromOID#)
      <isNotNull prepend="and" property="Name">
        A.Name like '%' + #Name# + '%'
      </isNotNull>
      <isNotNull prepend="and" property="Code">
        A.Code = #Code#
      </isNotNull>
      <isNotNull prepend="and" property="ViewUrl">
        A.ViewUrl = #ViewUrl#
      </isNotNull>
      <isNotNull prepend="and" property="CreateUsNm">
        C.Name like '%' + #CreateUsNm# + '%'
      </isNotNull>
      AND A.DeleteDt IS NULL
    </select>

    

  </statements>
</sqlMap>