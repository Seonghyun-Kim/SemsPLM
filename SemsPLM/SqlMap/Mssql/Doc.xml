<?xml version="1.0" encoding="utf-8" ?>
<sqlMap
 namespace="Doc"
	xmlns="http://ibatis.apache.org/mapping"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <alias>
    <typeAlias alias="Doc"  type="Document.Models.Doc" />
  </alias>

  <statements>
    
    <insert id="InsDoc" parameterClass="Doc">
      INSERT INTO T_DDOCUMENT
      (OID
      ,DocType
      ,Title
      ,DocGroup
      )
      VALUES
      (#OID#
      ,#DocType#
      ,#Title#
      ,#DocGroup#
      )
    </insert>


    <select id="SelDoc" parameterClass="Doc" resultClass="Doc">
      SELECT
      A.*
      , B.*
      FROM T_DOBJECT A
      LEFT OUTER JOIN T_DDOCUMENT B ON A.OID = B.OID
      <dynamic prepend="where">
        <isNotNull prepend="and" property="Type">
          A.Type = #Type#
        </isNotNull>
        <isNotNull prepend="and" property="OID">
          A.OID = #OID#
        </isNotNull>
        <isNotNull prepend="and" property="Name">
          A.Name LIKE CONCAT('%',#Name#,'%')
        </isNotNull>
        <isNotNull prepend="and" property="Description">
          A.Description LIKE CONCAT('%',#Description#,'%')
        </isNotNull>
        <isNotNull prepend="and" property="DocType">
          B.DocType = #DocType#
        </isNotNull>
        <isNotNull prepend="and" property="Title">
          B.Title LIKE CONCAT('%',#Title#,'%')
        </isNotNull>
        <isNotNull prepend="and" property="Eo_No">
          B.Eo_No LIKE CONCAT('%',#Eo_No#,'%')
        </isNotNull>
        <isNotNull prepend="and" property="DocGroup">
          B.DocGroup = #DocGroup#
        </isNotNull>
      </dynamic>
      AND A.DeleteDt IS NULL
    </select>
    
  
  <update id="UdtDoc" parameterClass="Doc">
    UPDATE T_DDOCUMENT
    <dynamic prepend="SET">
    <isNotNull prepend="," property="DocType">
      DocType = #DocType#
    </isNotNull>
    <isNotNull prepend="," property="Title">
      Title =  #Title#
    </isNotNull>
    WHERE OID   =  #OID#
  </dynamic>
  </update>

    
  </statements>

</sqlMap>