@{
    Layout = null;
}

<div id="listView">
    <div style="width:100%; margin-right:20px;">
        <!--검색창-->
        <div class="searchBox">
            <div class="searchTitle">
                <label><i class="fas fa-folder-open"></i> &nbsp;신속대응 검색</label>
            </div>
            <div class="searchContent">
                <div class="searchData">
                    <div style="transform:translateY(-20px);">구분</div>
                    <div>
                        <div id="SearchDocument_DocType" style="margin-left:5px;"></div>
                    </div>
                </div>
                <div class="searchData">
                    <div>품번</div>
                    <div>
                        <input type="text" class="txtBox" id="SearchDocument_Name" />
                    </div>
                </div>
                <div class="searchData">
                    <div>제목</div>
                    <div>
                        <input type="text" class="txtBox" id="SearchDocument_Title" />
                    </div>
                </div>
                <div class="searchData">
                    <div>EO NO</div>
                    <div>
                        <input type="text" class="txtBox" id="SearchDocument_Eo_No" />
                    </div>
                </div>

                <div class="searchData">
                    <div>작성자</div>
                    <div>
                        <input type="text" class="txtBox" id="SearchDocument_CreatUs" />
                    </div>
                </div>
                <div class="searchButton">
                    <button id="SearchDocument_btnSearch" class="searchBtn custom-button" onclick=""><i class="fas fa-search"></i> 검색</button>
                </div>
            </div>         
        </div>
    </div>
    <div id="SearchQuickResponse_Grid"></div>
</div>

<script type="text/javascript">
    var QuickResponseSource =
    {
        dataType: "json",
        dataFields: [
            { name: 'OID', type: 'number' },
            { name: 'Name', type: 'string' },
            { name: 'OccurrenceDt', type: 'date' },
            { name: 'OccurrenceNm', type: 'string' },
            { name: 'PartNo', type: 'string' },
            { name: 'PartNm', type: 'string' },
            { name: 'CarCode', type: 'string' },
            { name: 'PartGrpNm', type: 'string' },
            { name: 'Summary', type: 'string' },
            { name: 'CreateUsNm', type: 'string' },
            { name: 'PlanUserNm', type: 'string' },
            { name: 'FinishDt', type: 'date' },
          
        ],
        type: "POST",
        url : "/Qms/SelQuickResponseGridList"
    };

    $(document).ready(function () {
         var quickResponseList$ = $('#SearchQuickResponse_Grid');
        quickResponseList$.jqxGrid({
            theme: "kdnc",
            width: '100%',
            height: '84.5%',
            rowsheight: 28,
            columnsheight: 30,
            source :  new $.jqx.dataAdapter(QuickResponseSource),
            sortable: false,
            pageable: false,
            selectionmode: 'singlerow',
            showtoolbar: true,
            toolbarheight: 45,
            columns: [
                {
                    text: 'NO', width: '5%', cellsalign: 'center', columntype: 'number', align: 'center',
                    cellsrenderer: function (row, column, value) {
                        return "<div style='width:100%;height:100%;text-align:center;vertical-align:middle;line-height:1.9;'>" + (value + 1) + "</div>";
                    }
                },
                { text: 'ID', dataField: 'ID', width: '15%', align: 'center', cellsalign: 'center', },
                { text: '이름', dataField: 'Name', width: '15%', align: 'center', cellsalign: 'center', },
                { text: '발생일자', dataField: 'OccurrenceDt', width: '13%', align: 'center', cellsalign: 'center', cellsFormat: 'yyyy-MM-dd', },
                { text: '발생유형', dataField: 'OccurrenceNm', width: '10%', align: 'center', cellsalign: 'center', },
                { text: '품번', dataField: 'PartNo', width: '10%', align: 'center', cellsalign: 'center', },
                
                { text: '품명', dataField: 'PartNm', width: '15%', align: 'center', cellsalign: 'center', },
                { text: '차종', dataField: 'CarCode', width: '10%', align: 'center', cellsalign: 'center', },
                { text: '문제내용', dataField: 'Summary', width: '20%', align: 'center', cellsalign: 'center', },
                { text: '작성자', dataField: 'CreateUsNm', width: '10%', align: 'center', cellsalign: 'center', },
                { text: '시정조치담당자', dataField: 'PlanUserNm', width: '16%', align: 'center', cellsalign: 'center', },
                { text: '종결일자', dataField: 'FinishDt', width: '13%', align: 'center', cellsalign: 'center', cellsFormat: 'yyyy-MM-dd', },
            ],
            rendertoolbar: function (toolBar) {
                var container = $("<div class='lGridComponent' ></div>");
                var addButton = $("<button class='custom-button'><i class='fas fa-plus'></i> 추가</button>").jqxButton();
                var deleteButton = $("<button class='custom-button'><i class='fas fa-minus'></i> 삭제</button>").jqxButton();
                container.append(addButton);
                container.append(deleteButton);

                addButton.on('click', function () {
                    OpenDlgQuickResponse(null);
                });

                deleteButton.on('click', function () {
                   
                });

                toolBar.append(container);
            }
        });

    });

    function OpenDlgQuickResponse(QuickResponseOID) {
        var popTitle = "";
        if (QuickResponseOID === null) {
            popTitle = "신규 신속대응 등록";
        } else {
            popTitle = "선택 신속대응 수정";
        }

        var dlgDivWrap = document.createElement("div");

        dlgDivWrap.id = "dlgEditQuickResponse";
        var dlgDivTitle = document.createElement("div");
        var dlgDivView = document.createElement("div");

        dlgDivWrap.appendChild(dlgDivTitle);
        dlgDivWrap.appendChild(dlgDivView);

        var param = {};
        param.OID = QuickResponseOID;

        $(dlgDivView).load("/Qms/EditQuickResponse", param, function () {
            var winHeight = $(window).height();
            var winWidth = $(window).width();            

            var posX = (winWidth / 2) - (1100/ 2) + $(window).scrollLeft();
            var posY = (winHeight / 2) - (900 / 2) + $(window).scrollTop();

            $(dlgDivWrap).jqxWindow({ width: 1100, height: 900, minWidth: 1100, minHeight: 900, draggable: true, resizable: true, isModal: true, autoOpen: false, modalOpacity: 0.5, showCloseButton: true, position: { x: posX, y: posY },
                initContent: function () {

                }
            });
            $(dlgDivWrap).jqxWindow('setTitle', popTitle);
            $(dlgDivWrap).jqxWindow("show");
        });

        $(dlgDivWrap).on('close', function (event) {
            //_DlgAttributeItem();
            $(dlgDivWrap).jqxWindow('modalDestory');
            //GetAttributeItemList();
        });
    }

    function CloseDlgQuickResponse() {
        $("#dlgEditQuickResponse").jqxWindow("close");
    }
</script>