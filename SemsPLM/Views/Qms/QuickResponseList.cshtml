@{
    Layout = null;
}

<div id="listView">
    <div style="width:100%; margin-right:20px;">
        <!--검색창-->
        <div class="searchBox">
            <div class="searchTitle">
                <label><i class="fas fa-folder-open"></i> &nbsp;신속대응 검색</label>
            </div>
            <div class="searchContent">
                <div class="searchData">
                    <div style="transform:translateY(-20px);">구분</div>
                    <div>
                        <div id="SearchDocument_DocType" style="margin-left:5px;"></div>
                    </div>
                </div>
                <div class="searchData">
                    <div>품번</div>
                    <div>
                        <input type="text" class="txtBox" id="SearchDocument_Name" />
                    </div>
                </div>
                <div class="searchData">
                    <div>제목</div>
                    <div>
                        <input type="text" class="txtBox" id="SearchDocument_Title" />
                    </div>
                </div>
                <div class="searchData">
                    <div>EO NO</div>
                    <div>
                        <input type="text" class="txtBox" id="SearchDocument_Eo_No" />
                    </div>
                </div>

                <div class="searchData">
                    <div>작성자</div>
                    <div>
                        <input type="text" class="txtBox" id="SearchDocument_CreatUs" />
                    </div>
                </div>
                <div class="searchButton">
                    <button id="SearchDocument_btnSearch" class="searchBtn custom-button" onclick=""><i class="fas fa-search"></i> 검색</button>
                </div>
            </div>         
        </div>
    </div>
    <div id="SearchQuickResponse_Grid"></div>
</div>

<script type="text/javascript">
    var QuickResponseSource =
    {
        dataType: "json",
        dataFields: [
            { name: 'OID', type: 'number' },
            { name: 'Name', type: 'string' },
            { name: 'OccurrenceDt', type: 'date' },
            { name: 'OccurrenceNm', type: 'string' },
            { name: 'PartNo', type: 'string' },
            { name: 'PartNm', type: 'string' },
            { name: 'CarCode', type: 'string' },
            { name: 'PartGrpNm', type: 'string' },
            { name: 'Summary', type: 'string' },
            { name: 'CreateUsNm', type: 'string' },
            { name: 'PlanUserNm', type: 'string' },
            { name: 'FinishDt', type: 'date' },
          
        ],
        type: "POST",
        url : "/Qms/SelQuickResponseGridList"
    };

    $(document).ready(function () {
        var aa = "aaaaasd";
         var quickResponseList$ = $('#SearchQuickResponse_Grid');
        quickResponseList$.jqxGrid({
            theme: "kdnc",
            width: '100%',
            height: 600,
            rowsheight: 40,
            columnsheight: 30,
            source :  new $.jqx.dataAdapter(QuickResponseSource),
            sortable: false,
            pageable: false,
            selectionmode: 'singlerow',
            showtoolbar: true,
            toolbarheight: 45,
            columns: [
                {
                    text: 'NO', dataField: 'NO', width: '2.5%', cellsalign: 'center', columntype: 'number', align: 'center', pinned:true,
                    cellsrenderer: function (row, column, value) {
                        return "<div style='width:100%;height:100%;text-align:center;vertical-align:middle;line-height:1.9;'>" + (value + 1) + "</div>";
                    }
                },
                {
                    text: '신속대응NO', dataField: 'Name', width: '11%', align: 'center', cellsalign: 'center', pinned: true,
                    cellsrenderer: function (row, column, value) {    
                        return "<div style='display:flex;align-items:center;width:100%;height:100%;'><div style='width:calc(100%- 10px);margin-left:5px;'><a href='javascript:alert(\"" + aa + "\")'>" + (value) + "</a></div></div>";
                    }
                },
                { text: '발생일자', dataField: 'OccurrenceDt', width: '6%', align: 'center', cellsalign: 'center', cellsFormat: 'yyyy-MM-dd', pinned:true },
                { text: '발생유형', dataField: 'OccurrenceNm', width: '6%', align: 'center', cellsalign: 'center', pinned:true },
                { text: '품번', dataField: 'PartNo', width: '8%', align: 'center', cellsalign: 'center', pinned:true },                
                { text: '품명', dataField: 'PartNm', width: '8%', align: 'center', cellsalign: 'center', pinned:true },
                { text: '차종', dataField: 'CarCode', width: '6%', align: 'center', cellsalign: 'center' },
                { text: '문제내용', dataField: 'Summary', width: '15%', align: 'center', cellsalign: 'center' },
                { text: '신속대응등록자', dataField: 'CreateUsNm', width: '7%', align: 'center', cellsalign: 'center' },          
                { text: '시정조치담당자', dataField: 'PlanUserNm', width: '7%', align: 'center', cellsalign: 'center' },
                { text: '종결일자', dataField: 'FinishDt', width: '6%', align: 'center', cellsalign: 'center', cellsFormat: 'yyyy-MM-dd' },                         
                {
                    text: '', dataField: '', width: '80px', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var btnHistory = "<div><button id='btnPlanDate' class='btnGridBtn' style='width:77px;height:38px;text-align:center;line-height:0.5;padding:4px 5px;' title='일정관리' onclick='javascript:OpenDlgQuickResponsePlan(" + rowData.OID + ");'>일정관리</button></div>";
                      
                        return "<div style='width:auto;display:flex;flex-direction:column;justify-content:center;align-content:center;padding:0px;margin-top:1px;margin-left:2px;'>" + btnHistory + "</div>";
                    }
                },
                {
                    text: '봉쇄조치(24H)', dataField: 'Blockade', width: '8%', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var moduleDate = "<div style='width:100%;text-align:center;border-bottom:1px dotted #9D9292;'><a href='javascript:alert(\"" + aa + "\")'>AA</a></div>";
                        var moduleChargerUser = "<div style='width:100%;text-align:center;'>AB</div>";
                        return "<div>" + moduleDate + moduleChargerUser + "</div>";
                    }
                },
                {
                    text: '원인분석(7D)', dataField: 'OccurrenceCause', width: '8%', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var moduleDate = "<div style='width:100%;text-align:center;border-bottom:1px dotted #9D9292;'><a href='javascript:alert(\"" + aa + "\")'>AA</a></div>";
                        var moduleChargerUser = "<div style='width:100%;text-align:center;'>AB</div>";
                        return "<div>" + moduleDate + moduleChargerUser + "</div>";
                    }
                },
                {
                    text: '개선대책(14D)', dataField: 'ImproveCountermeasure', width: '8%', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var moduleDate = "<div style='width:100%;text-align:center;border-bottom:1px dotted #9D9292;'><a href='javascript:alert(\"" + aa + "\")'>AA</a></div>";
                        var moduleChargerUser = "<div style='width:100%;text-align:center;'>AB</div>";
                        return "<div>" + moduleDate + moduleChargerUser + "</div>";
                    }
                },
                {
                    text: 'Error Proof', dataField: 'ErrorProof', width: '8%', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var moduleDate = "<div style='width:100%;text-align:center;border-bottom:1px dotted #9D9292;'><a href='javascript:alert(\"" + aa + "\")'>AA</a></div>";
                        var moduleChargerUser = "<div style='width:100%;text-align:center;'>AB</div>";
                        return "<div>" + moduleDate + moduleChargerUser + "</div>";
                    }
                },
                {
                    text: 'LPA 감사', dataField: 'LpaUnfit', width: '8%', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var moduleDate = "<div style='width:100%;text-align:center;border-bottom:1px dotted #9D9292;'><a href='javascript:alert(\"" + aa + "\")'>AA</a></div>";
                        var moduleChargerUser = "<div style='width:100%;text-align:center;'>AB</div>";
                        return "<div>" + moduleDate + moduleChargerUser + "</div>";
                    }
                },
                {
                    text: '유효성 검증(34D)', dataField: 'Check', width: '8%', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var moduleDate = "<div style='width:100%;text-align:center;border-bottom:1px dotted #9D9292;'><a href='javascript:alert(\"" + aa + "\")'>AA</a></div>";
                        var moduleChargerUser = "<div style='width:100%;text-align:center;'>AB</div>";
                        return "<div>" + moduleDate + moduleChargerUser + "</div>";
                    }
                },
                {
                    text: '표준F/U(35D)', dataField: 'Standard', width: '8%', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var moduleDate = "<div style='width:100%;text-align:center;border-bottom:1px dotted #9D9292;'><a href='javascript:alert(\"" + aa + "\")'>AA</a></div>";
                        var moduleChargerUser = "<div style='width:100%;text-align:center;'>AB</div>";
                        return "<div>" + moduleDate + moduleChargerUser + "</div>";
                    }
                },
                {
                    text: '작업자교육(40D)', dataField: 'WorkerEdu', width: '8%', align: 'center', cellsalign: 'center',
                    cellsrenderer: function (row, columnfield, value, defaulthtml, columnproperties, rowData) {                 
                        var moduleDate = "<div style='width:100%;text-align:center;border-bottom:1px dotted #9D9292;'><a href='javascript:alert(\"" + aa + "\")'>AA</a></div>";
                        var moduleChargerUser = "<div style='width:100%;text-align:center;'>AB</div>";
                        return "<div>" + moduleDate + moduleChargerUser + "</div>";
                    }
                },                       
                { text: '상태', dataField: 'StatusNm', width: '5%', align: 'center', cellsalign: 'center' },
            ],
            rendertoolbar: function (toolBar) {
                var container = $("<div class='lGridComponent' ></div>");
                var addButton = $("<button class='custom-button'><i class='fas fa-plus'></i> 추가</button>").jqxButton();
                var deleteButton = $("<button class='custom-button'><i class='fas fa-minus'></i> 삭제</button>").jqxButton();
                container.append(addButton);
                container.append(deleteButton);

                addButton.on('click', function () {
                    OpenDlgQuickResponse(null);
                });

                deleteButton.on('click', function () {
                   
                });

                toolBar.append(container);
            }
        });

    });

    function OpenDlgQuickResponse(QuickResponseOID) {
        var popTitle = "";
        if (QuickResponseOID === null) {
            popTitle = "신규 신속대응 등록";
        } else {
            popTitle = "선택 신속대응 수정";
        }

        var dlgDivWrap = document.createElement("div");

        dlgDivWrap.id = "dlgEditQuickResponse";
        var dlgDivTitle = document.createElement("div");
        var dlgDivView = document.createElement("div");

        dlgDivWrap.appendChild(dlgDivTitle);
        dlgDivWrap.appendChild(dlgDivView);

        var param = {};
        param.OID = QuickResponseOID;

        $(dlgDivView).load("/Qms/EditQuickResponse", param, function () {
            var winHeight = $(window).height();
            var winWidth = $(window).width();            

            var posX = (winWidth / 2) - (1100/ 2) + $(window).scrollLeft();
            var posY = (winHeight / 2) - (900 / 2) + $(window).scrollTop();

            $(dlgDivWrap).jqxWindow({ width: 1100, height: 900, minWidth: 1100, minHeight: 900, draggable: true, resizable: true, isModal: true, autoOpen: false, modalOpacity: 0.5, showCloseButton: true, position: { x: posX, y: posY },
                initContent: function () {

                }
            });
            $(dlgDivWrap).jqxWindow('setTitle', popTitle);
            $(dlgDivWrap).jqxWindow("show");
        });

        $(dlgDivWrap).on('close', function (event) {
            //_DlgAttributeItem();
            $(dlgDivWrap).jqxWindow('modalDestory');
            //GetAttributeItemList();
        });
    }

    function CloseDlgQuickResponse() {
        $("#dlgEditQuickResponse").jqxWindow("close");
    }

    function OpenDlgQuickResponsePlan(QuickResponseOID) {
        var popTitle = "신속대응 일정수립";     

        var dlgDivWrap = document.createElement("div");

        dlgDivWrap.id = "dlgEditQuickResponsePlan";
        var dlgDivTitle = document.createElement("div");
        var dlgDivView = document.createElement("div");

        dlgDivWrap.appendChild(dlgDivTitle);
        dlgDivWrap.appendChild(dlgDivView);

        var param = {};
        param.OID = QuickResponseOID;

        $(dlgDivView).load("/Qms/EditQuickResponsePlan", param, function () {
            var winHeight = $(window).height();
            var winWidth = $(window).width();            

            var posX = (winWidth / 2) - (1100/ 2) + $(window).scrollLeft();
            var posY = (winHeight / 2) - (900 / 2) + $(window).scrollTop();

            $(dlgDivWrap).jqxWindow({ width: 1100, height: 900, minWidth: 1100, minHeight: 900, draggable: true, resizable: true, isModal: true, autoOpen: false, modalOpacity: 0.5, showCloseButton: true, position: { x: posX, y: posY },
                initContent: function () {

                }
            });
            $(dlgDivWrap).jqxWindow('setTitle', popTitle);
            $(dlgDivWrap).jqxWindow("show");
        });

        $(dlgDivWrap).on('close', function (event) {
            //_DlgAttributeItem();
            $(dlgDivWrap).jqxWindow('modalDestory');
            //GetAttributeItemList();
        });
    }

    function CloseDlgQuickResponsePlan() {
        $("#dlgEditQuickResponsePlan").jqxWindow("close");
    }
</script>