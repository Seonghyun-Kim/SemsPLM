@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title></title>
</head>
<body>
    <div>
        <h4 class="cleanTitle"><i class="fas fa-archive"></i> 산출물</h4>
        <div id="pmMyDeliveryGrid"></div>
    </div>
    <script type="text/javascript">
        $(function () {
            var deliverySource = {
                dataType: "json",
                dataFields: [
                    { name: 'OID', type: 'number' },
                    { name: 'ToOID', type: 'number' },
                    { name: 'Type', type: 'string' },
                    { name: 'DocName', type: 'string' },
                    { name: 'Oem_Lib_Nm', type: 'string' },
                    { name: 'Car_Lib_Nm', type: 'string' },
                    { name: 'DocNm', type: 'string' },
                    { name: 'DocOID', type: 'number' },
                    { name: 'DocNo', type: 'string' },
                    { name: 'DocNoNm', type: 'string' },
                    { name: 'DocSt', type: 'number' },
                    { name: 'DocStNm', type: 'string' },
                    { name: 'DocRev', type: 'string' },
                    { name: 'ViewUrl', type: 'string' },
                    { name: 'CreateDt', type: 'date' },
                    { name: 'CreateUsNm', type: 'string' },
                    { name: 'ProjectNm', type: 'string' },
                    { name: 'DocClassNm', type: 'string' },
                    { name: 'TaskNm', type: 'string' },
                ],
                id: 'OID',
            }
            $('#pmMyDeliveryGrid').jqxGrid({
                width: '100%',
                height: 550,
                editable: false,
                columns: [
                    {
                        text: 'NO', width: "5%", cellsalign: 'center', columntype: 'number', align: 'center',
                        cellsrenderer: function (row, column, value) {
                            return "<div style='width:100%;height:100%;text-align:center;vertical-align:middle;line-height:1.9;'>" + (value + 1) + "</div>";
                        }
                    },
                    { text: '프로젝트명', datafield: 'ProjectNm', width: "25%", align: 'center', cellsalign: 'center', },
                    { text: 'OEM', datafield: 'Oem_Lib_Nm', width: "10%", align: 'center', cellsalign: 'center', },
                    { text: '차종', datafield: 'Car_Lib_Nm', width: "10%", align: 'center', cellsalign: 'center', },
                    { text: '작업명', datafield: 'TaskNm', width: "10%", align: 'center', cellsalign: 'center', },
                    { text: '분류체계명', datafield: 'DocClassNm', width: "10%", align: 'center', cellsalign: 'center', },
                    { text: '문서명', datafield: 'DocNm', width: "10%", align: 'center', cellsalign: 'center', },
                    { text: '리비전', datafield: 'DocRev', width: "10%", align: 'center', cellsalign: 'center', },
                    { text: '상태', datafield: 'DocStNm', width: "10%", align: 'center', cellsalign: 'center', },
                    { text: '생성일', datafield: 'CreateDt', width: "10%", align: 'center', cellsalign: 'center', cellsFormat: 'yyyy-MM-dd', },
                    { text: '생성자', datafield: 'CreateUsNm', cellsalign: 'center', align: 'center', width: '5%' },

                ],
            });
            RequestData("/Pms/@ViewBag.linker", {}, function (res) {
                PrintJqxGrid(deliverySource, $('#pmMyDeliveryGrid'), res);
            });

            $('#pmMyDeliveryGrid').on('celldoubleclick', function (event) {
                const row = event.args.row.bounddata;

                if (row.Type == '@Common.Constant.PmsConstant.RELATIONSHIP_DOC_CLASS') {
                    var param = {};
                    param.OID = row.ToOID;
                    if (row.ViewUrl == null) {
                        param.Type = '@Common.Constant.DocumentConstant.TYPE_DOCUMENT';
                        if (gClickDuplication) { return; }
                        gClickDuplication = true;
                        setTimeout(function () {
                            OpenPmsDocumentDialog(function (res) {
                                RequestData("/Pms/@ViewBag.linker", {}, function (res) {
                                    PrintJqxGrid(deliverySource, $('#pmMyDeliveryGrid'), res);
                                });
                            }, null, param, '/Pms/InfoDocument', '문서 상세');
                            gClickDuplication = false;
                        }, 250);
                    } else {
                        if (row.DocClassNm == "@Common.Constant.DocClassConstant.ATTRIBUTE_RELIABILITY") {
                            if (gClickDuplication) { return; }
                            gClickDuplication = true;
                            setTimeout(function () {
                                OpenInfoReliabilityDialog(function (res) {
                                    RequestData("/Pms/@ViewBag.linker", {}, function (res) {
                                        PrintJqxGrid(deliverySource, $('#pmMyDeliveryGrid'), res);
                                    });
                                }, null, param, '/Pms/dlgInfoReliabilityForm', '신뢰성 시험 의뢰서 상세');
                                gClickDuplication = false;
                            }, 250);
                        } else {
                            if (gClickDuplication) { return; }
                            gClickDuplication = true;
                            setTimeout(function () {
                                OpenInfoReliabilityReportDialog(function (res) {
                                    RequestData("/Pms/@ViewBag.linker", {}, function (res) {
                                        PrintJqxGrid(deliverySource, $('#pmMyDeliveryGrid'), res);
                                    });
                                }, null, param, '/Pms/dlgInfoReliabilityReport', '신뢰성 시험 결과서 상세');
                                gClickDuplication = false;
                            }, 250);
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>
